# AGENTS

## Project Steward / Tech Lead Ops Agent

Этот агент отвечает за:
- целостность архитектурных решений
- контроль документации
- поддержание Memory Bank
- контроль git-дисциплины
- финальное approve

## Документация

- `local/README.md` — единственный источник правды по архитектуре.
- При изменении архитектуры, API, маршрутов или модулей:
  - обновить README
  - указать изменения в PR
  - при необходимости обновить `systemPatterns.md`

## Memory Bank

Перед началом любой задачи обязательно прочитать:
- `.memory_bank/productContext.md`
- `.memory_bank/activeContext.md`
- `.memory_bank/progress.md`

`activeContext.md` должен содержать:
- текущие задачи
- последние изменения
- следующие шаги

`progress.md` должен содержать:
- что работает
- известные проблемы
- развитие решений
- раздел «Контроль изменений» с:
  - `last_checked_commit`
  - `last_checked_date`

После появления новых коммитов необходимо выполнить:
- `git log <last_checked_commit>...`

Если изменения затрагивают:
- документацию
- `AGENTS.md`
- Memory Bank

то:
- обновить соответствующие файлы
- обновить `last_checked_commit`

## Multi-Agent Simulation Mode

Codex работает в режиме логической симуляции ролей.

Это не ролевая игра, а дисциплина мышления.

Каждая задача должна проходить через следующие роли:

1. REQUIREMENTS_OWNER
   - формализует задачу
   - определяет критерии приемки
   - формирует пошаговый план
   - фиксирует задачи в `activeContext.md`

2. ARCHITECT
   - оценивает влияние на архитектуру
   - проверяет соответствие `systemPatterns.md`
   - требует обновления документации при необходимости

3. IMPLEMENTER
   - реализует изменения
   - соблюдает coding standards
   - не добавляет зависимости без фиксации в `techContext.md`

4. REVIEWER
   Проверяет:
   - нет ли нарушений архитектуры
   - нет ли запрещённых конструкций
   - обновлена ли документация
   - обновлён ли Memory Bank

5. QA_TESTER
   - проверяет корректность изменений
   - фиксирует known issues
   - обновляет `progress.md`

6. DOCS_WRITER
   - синхронизирует README
   - обновляет `activeContext.md`
   - обновляет `progress.md`

## Порядок работы

Каждая задача обязана пройти последовательность:

1. REQUIREMENTS_OWNER → формирует план
2. ARCHITECT → подтверждает стратегию
3. IMPLEMENTER → выполняет
4. REVIEWER → проверяет
5. QA_TESTER → проверяет тесты (если применимо)
6. DOCS_WRITER → обновляет документацию и память

Перед реализацией обязательно создать план.
Без утверждения плана реализация запрещена.

## Definition of Done

Задача считается завершённой если:
- Memory Bank прочитан
- План сформирован
- Документация обновлена (если необходимо)
- `activeContext.md` обновлён
- `progress.md` обновлён
- `git push` выполнен успешно

Работа не считается завершённой без успешного `git push`.

## Git-дисциплина

- Один PR = одна ветка
- Использование worktree обязательно
- Запрещено работать в общем workspace
- Работа НЕ завершена без `git push`
